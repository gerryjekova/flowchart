<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 Goals Interactive Presentation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        /* Base Styles */
        :root {
            --color-yellow: #FFD600;
            --color-purple: #AA00FF;
            --color-blue: #2962FF;
            --color-orange: #FF6D00;
            --color-light-purple: #E1BEE7;
            --color-light-green: #C8E6C9;
            --color-green: #00C853;
            --color-light-blue: #E2EBFF;
            --color-red-light: #FFCDD2;
            --color-yellow-light: #FFF9C4;
            --color-background: #f9f9f9;
            --color-text: #333;
            --color-border: #ddd;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --radius: 8px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--color-background);
            color: var(--color-text);
            overflow-x: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        h1, h2, h3, h4 {
            margin-bottom: 0.5rem;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, var(--color-purple), var(--color-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            padding: 20px 0;
        }

        header {
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            box-shadow: var(--shadow);
            z-index: 10;
        }

        main {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .flowchart-container {
            position: absolute;
            width: 100%;
            height: 100%;
            transition: transform 0.5s ease;
        }

        /* SVG Flowchart Styling */
        .node {
            cursor: pointer;
            transition: transform 0.3s ease, filter 0.3s ease;
        }

        .node:hover {
            transform: scale(1.05);
            filter: brightness(1.1);
        }

        .node-text {
            font-size: 14px;
            font-weight: 600;
            pointer-events: none;
        }

        .link {
            stroke-width: 2px;
            stroke: #999;
            fill: none;
            transition: stroke-width 0.3s ease, stroke 0.3s ease;
        }

        .link-active {
            stroke-width: 3px;
            stroke: var(--color-purple);
        }

        /* Modal Styling */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            width: 80%;
            max-width: 1000px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.8);
            transition: var(--transition);
            padding: 30px;
            position: relative;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1);
        }

        .close-modal {
            position: absolute;
            right: 20px;
            top: 20px;
            background: var(--color-red-light);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .close-modal:hover {
            background: #ff8a80;
            transform: rotate(90deg);
        }

        /* Content Cards */
        .card {
            background-color: white;
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }

        .two-columns {
            display: flex;
            gap: 30px;
            margin: 20px 0;
        }

        .column {
            flex: 1;
        }

        @media (max-width: 768px) {
            .two-columns {
                flex-direction: column;
            }
        }

        /* Controls */
        .controls {
            position: fixed;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 10px;
            z-index: 100;
        }

        .control-btn {
            background-color: rgba(255, 255, 255, 0.8);
            border: 1px solid var(--color-border);
            border-radius: 50px;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: var(--shadow);
        }

        .control-btn:hover {
            background-color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }

        /* Status Indicators */
        .status-completed {
            display: inline-block;
            padding: 3px 8px;
            background-color: var(--color-light-green);
            border-radius: 4px;
            margin-right: 5px;
            font-weight: bold;
        }

        .status-progress {
            display: inline-block;
            padding: 3px 8px;
            background-color: var(--color-yellow-light);
            border-radius: 4px;
            margin-right: 5px;
            font-weight: bold;
        }

        .status-not-started {
            display: inline-block;
            padding: 3px 8px;
            background-color: #f5f5f5;
            border-radius: 4px;
            margin-right: 5px;
            font-weight: bold;
        }

        /* Zoom Controls */
        .zoom-controls {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 100;
        }

        .zoom-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            border: 1px solid var(--color-border);
            cursor: pointer;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: var(--transition);
        }

        .zoom-btn:hover {
            background: var(--color-light-blue);
            transform: scale(1.1);
        }

        /* Loading Animation */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--color-background);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .loading.loaded {
            opacity: 0;
            visibility: hidden;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--color-purple);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Navigation indicator */
        .breadcrumb {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: var(--radius);
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 100;
            box-shadow: var(--shadow);
            font-size: 14px;
            max-width: 60%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
    </style>
</head>
<body>
    <div class="loading">
        <div class="spinner"></div>
    </div>

    <header>
        <h1>2025 GOALS PROGRESS TRACKER</h1>
    </header>

    <main>
        <div class="flowchart-container" id="flowchart"></div>
        <div class="breadcrumb" id="breadcrumb">
            Home
        </div>
    </main>

    <div class="zoom-controls">
        <button class="zoom-btn" id="zoomIn">+</button>
        <button class="zoom-btn" id="zoomOut">-</button>
        <button class="zoom-btn" id="zoomReset">⟲</button>
    </div>

    <div class="controls">
        <button class="control-btn" id="resetView">Reset View</button>
        <button class="control-btn" id="expandAll">Expand All</button>
    </div>

    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-content" id="modalContent">
            <button class="close-modal" id="closeModal">✕</button>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        // Data structure based on the flowchart
        const flowchartData = {
            nodes: [
                { id: "A", label: "GOALS 2025<br>Progress", color: "#FFD600", borderColor: "#AA00FF", textColor: "#000000", shape: "rect" },
                { id: "n1", label: "Content", color: "#FF6D00", borderColor: "#FF6D00", textColor: "#000000" },
                { id: "n10", label: "Community &<br>Networking", color: "#E1BEE7", borderColor: "#E1BEE7", textColor: "#000000" },
                { id: "n13", label: "Professional", color: "#2962FF", borderColor: "#2962FF", textColor: "#FFFFFF" },
                { id: "n14", label: "Personal", color: "#FFD600", borderColor: "#FFD600", textColor: "#000000" },
                { id: "n11", label: "Twitch", color: "#AA00FF", borderColor: "#AA00FF", textColor: "#FFFFFF" },
                { id: "n12", label: "YouTube", color: "#FFE0B2", borderColor: "#FFE0B2", textColor: "#000000" },
                { id: "n4", label: "Programming", color: "#FFE0B2", borderColor: "#FFE0B2", textColor: "#000000" },
                { id: "n19", label: "Monetization", color: "#00C853", borderColor: "#00C853", textColor: "#000000" },
                { id: "n15", label: "3 CONTINUOUSLY IMPROVING<br>SUCCESSFUL STREAM INTEGRATIONS", color: "#FFFFFF", borderColor: "#00C853", textColor: "#000000", shape: "diamond" },
                { id: "n30", label: "Portfolio Building", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000" },
                { id: "n16", label: "Voices in Chat &<br>Autoresponses", color: "#C8E6C9", borderColor: "#C8E6C9", textColor: "#000000" },
                { id: "n17", label: "Wheel of Fortune", color: "#C8E6C9", borderColor: "#C8E6C9", textColor: "#000000" },
                { id: "n46", label: "Schedule", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000" },
                { id: "n18", label: "Unknown Yet", color: "#FFFFFF", borderColor: "#FF6D00", textColor: "#000000", icon: "❓" },
                { id: "n20", label: "DISCORD", color: "#E1BEE7", borderColor: "#E1BEE7", textColor: "#000000" },
                { id: "n29", label: "new people <3", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000", shape: "text" },
                { id: "n45", label: "Mods Making Chat Stricter", color: "#FFCDD2", borderColor: "#FFCDD2", textColor: "#000000" },
                { id: "n21", label: "Setup New Channels and Roles", color: "#FFF9C4", borderColor: "#FFF9C4", textColor: "#000000" },
                { id: "n23", label: "Bits + Subs Discord Role &<br>Section", color: "#FFCDD2", borderColor: "#FFCDD2", textColor: "#000000" },
                { id: "n22", label: "Bits Stream Integrations", color: "#FFCDD2", borderColor: "#FFCDD2", textColor: "#000000" },
                { id: "n24", label: "Focus on strengthening meaningful relationships", color: "#FFCDD2", borderColor: "#FFCDD2", textColor: "#000000" },
                { id: "n33", label: "Travel with Friends", color: "#FFE0B2", borderColor: "#FFE0B2", textColor: "#000000" },
                { id: "n44", label: "Got in Relationship", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000" },
                { id: "n31", label: "Freelance Content Manager", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000" },
                { id: "n32", label: "Community Manager for<br>PM Mentality", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000" },
                { id: "n34", label: "Burgas New Years", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000", shape: "text" },
                { id: "n35", label: "Romania", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000", shape: "text" },
                { id: "n36", label: "Теснолинейка стрийм", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000", shape: "text" },
                { id: "n37", label: "Start Posting Regularly", color: "#C8E6C9", borderColor: "#C8E6C9", textColor: "#000000" },
                { id: "n38", label: "Long-form videos", color: "#E1BEE7", borderColor: "#E1BEE7", textColor: "#000000" },
                { id: "n39", label: "From Stream", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000" },
                { id: "n40", label: "Independent", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000" },
                { id: "n41", label: "Into Shorts", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000" },
                { id: "n42", label: "Shorts", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000" },
                { id: "n43", label: "TikTok", color: "#FFFFFF", borderColor: "#000000", textColor: "#000000" }
            ],
            links: [
                { source: "A", target: "n1" },
                { source: "A", target: "n10" },
                { source: "A", target: "n13" },
                { source: "A", target: "n14" },
                { source: "n1", target: "n11" },
                { source: "n1", target: "n12" },
                { source: "n1", target: "n4" },
                { source: "n1", target: "n19" },
                { source: "n4", target: "n15" },
                { source: "n4", target: "n30" },
                { source: "n15", target: "n16" },
                { source: "n15", target: "n17" },
                { source: "n11", target: "n17" },
                { source: "n11", target: "n12" },
                { source: "n11", target: "n46" },
                { source: "n15", target: "n18", bidirectional: true },
                { source: "n19", target: "n11", bidirectional: true },
                { source: "n17", target: "n19", bidirectional: true },
                { source: "n10", target: "n20" },
                { source: "n10", target: "n29" },
                { source: "n10", target: "n45" },
                { source: "n20", target: "n21" },
                { source: "n21", target: "n19" },
                { source: "n21", target: "n23" },
                { source: "n19", target: "n22" },
                { source: "n22", target: "n21" },
                { source: "n14", target: "n24" },
                { source: "n14", target: "n33" },
                { source: "n24", target: "n29" },
                { source: "n24", target: "n44" },
                { source: "n24", target: "n45" },
                { source: "n24", target: "n10", bidirectional: true },
                { source: "n13", target: "n30" },
                { source: "n13", target: "n31" },
                { source: "n13", target: "n32" },
                { source: "n33", target: "n34" },
                { source: "n33", target: "n35" },
                { source: "n33", target: "n36" },
                { source: "n30", target: "n32" },
                { source: "n12", target: "n37" },
                { source: "n12", target: "n38" },
                { source: "n38", target: "n39" },
                { source: "n38", target: "n40" },
                { source: "n38", target: "n41" },
                { source: "n38", target: "n42" },
                { source: "n42", target: "n43" },
                { source: "n46", target: "n24" }
            ]
        };

        // Node details for modal content
        const nodeDetails = {
            "A": {
                title: "2025 GOALS PROGRESS",
                content: `
                    <div class="card bg-light-blue">
                        <h2>Overview</h2>
                        <p>This interactive flowchart presents a comprehensive view of the 2025 goals, organized across four main pillars:</p>
                        <ul>
                            <li>Content Creation (Orange)</li>
                            <li>Community & Networking (Purple)</li>
                            <li>Professional Growth (Blue)</li>
                            <li>Personal Development (Yellow)</li>
                        </ul>
                        <p>Navigate through the flowchart by clicking on nodes to expand details. Hover over nodes to highlight connections.</p>
                    </div>
                    <div class="two-columns">
                        <div class="column">
                            <div class="card">
                                <h3>How to Use This Tool</h3>
                                <ul>
                                    <li>Click on any node to see detailed information</li>
                                    <li>Use zoom controls to navigate the flowchart</li>
                                    <li>The breadcrumb trail shows your current location</li>
                                    <li>Reset view button returns to the main overview</li>
                                </ul>
                            </div>
                        </div>
                        <div class="column">
                            <div class="card">
                                <h3>Progress Summary</h3>
                                <div><span class="status-completed">✓</span> Completed: 8 goals</div>
                                <div><span class="status-progress">→</span> In Progress: 10 goals</div>
                                <div><span class="status-not-started">○</span> Not Started: 6 goals</div>
                            </div>
                        </div>
                    </div>
                `
            },
            "n1": {
                title: "Content Creation Strategy",
                content: `
                    <div class="card" style="border-top: 5px solid var(--color-orange);">
                        <h2>Content Creation Pillars</h2>
                        <p>The content creation strategy encompasses multiple platforms and technical development to create an engaging viewer experience.</p>
                    </div>
                    <div class="two-columns">
                        <div class="column">
                            <div class="card bg-light-purple">
                                <h3>Platform Integration</h3>
                                <ul>
                                    <li><strong>Twitch:</strong> Live streaming with interactive elements</li>
                                    <li><strong>YouTube:</strong> Long-form content and short clips</li>
                                    <li><strong>TikTok:</strong> Short-form content repurposing</li>
                                </ul>
                            </div>
                        </div>
                        <div class="column">
                            <div class="card bg-light-green">
                                <h3>Technical Development</h3>
                                <ul>
                                    <li><strong>Stream Integrations:</strong> Custom interactive elements</li>
                                    <li><strong>Monetization:</strong> Cohesive revenue strategy</li>
                                    <li><strong>Programming:</strong> Technical solutions for engagement</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Current Progress</h3>
                        <table style="width: 100%;">
                            <tr>
                                <th>Area</th>
                                <th>Status</th>
                                <th>Next Steps</th>
                            </tr>
                            <tr>
                                <td>Twitch</td>
                                <td><span class="status-progress">→</span> In Progress</td>
                                <td>Optimize schedule and integration features</td>
                            </tr>
                            <tr>
                                <td>YouTube</td>
                                <td><span class="status-progress">→</span> In Progress</td>
                                <td>Establish regular posting cadence</td>
                            </tr>
                            <tr>
                                <td>Programming</td>
                                <td><span class="status-completed">✓</span> 2/3 Complete</td>
                                <td>Develop third integration concept</td>
                            </tr>
                            <tr>
                                <td>Monetization</td>
                                <td><span class="status-progress">→</span> In Progress</td>
                                <td>Connect platform revenue streams</td>
                            </tr>
                        </table>
                    </div>
                `
            },
            "n10": {
                title: "Community & Networking",
                content: `
                    <div class="card bg-light-purple">
                        <h2>Community Development Strategy</h2>
                        <p>Building a vibrant, supportive community across platforms with meaningful connections and structured engagement opportunities.</p>
                    </div>
                    <div class="two-columns">
                        <div class="column">
                            <div class="card">
                                <h3>Discord Enhancements</h3>
                                <ul>
                                    <li><span class="status-completed">✓</span> New roles and channels structure</li>
                                    <li><span class="status-progress">→</span> Subscriber-exclusive sections</li>
                                    <li><span class="status-progress">→</span> Bits integration for perks</li>
                                    <li><span class="status-not-started">○</span> Community recognition system</li>
                                </ul>
                            </div>
                        </div>
                        <div class="column">
                            <div class="card">
                                <h3>Chat Experience</h3>
                                <ul>
                                    <li><span class="status-progress">→</span> Moderation improvements</li>
                                    <li><span class="status-completed">✓</span> Clear chat guidelines</li>
                                    <li><span class="status-progress">→</span> Moderation team expansion</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card bg-yellow-light">
                        <h3>Networking Growth</h3>
                        <p>Building connections with fellow content creators and industry professionals to expand reach and open collaboration opportunities.</p>
                        <div class="two-columns">
                            <div class="column">
                                <h4>Creator Connections</h4>
                                <ul>
                                    <li>Collaborative streams</li>
                                    <li>Cross-promotion opportunities</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h4>Industry Networking</h4>
                                <ul>
                                    <li>Professional events</li>
                                    <li>Platform relationships</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `
            },
            "n13": {
                title: "Professional Growth",
                content: `
                    <div class="card bg-light-blue">
                        <h2>Professional Development Strategy</h2>
                        <p>Advancing career opportunities through portfolio development, technical expertise showcase, and industry relationships.</p>
                    </div>
                    <div class="two-columns">
                        <div class="column">
                            <div class="card">
                                <h3>Current Positions</h3>
                                <ul>
                                    <li><span class="status-completed">✓</span> Community Manager for PM Mentality</li>
                                    <li><span class="status-completed">✓</span> Freelance Content Manager</li>
                                </ul>
                            </div>
                            <div class="card">
                                <h3>Portfolio Development</h3>
                                <p>Showcasing technical skills and creativity through:</p>
                                <ul>
                                    <li>Stream integration development</li>
                                    <li>Interactive web applications</li>
                                    <li>Content management systems</li>
                                </ul>
                            </div>
                        </div>
                        <div class="column">
                            <div class="card">
                                <h3>Future Opportunities</h3>
                                <p>Exploring additional career paths in:</p>
                                <ul>
                                    <li>Technical content creation</li>
                                    <li>Community management</li>
                                    <li>Interactive media development</li>
                                </ul>
                            </div>
                            <div class="card bg-yellow-light">
                                <h3>Skills Development</h3>
                                <ul>
                                    <li><span class="status-progress">→</span> Advanced programming techniques</li>
                                    <li><span class="status-progress">→</span> Community management frameworks</li>
                                    <li><span class="status-not-started">○</span> Content strategy certification</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `
            },
            "n14": {
                title: "Personal Development",
                content: `
                    <div class="card bg-light-yellow">
                        <h2>Personal Growth Journey</h2>
                        <p>Focusing on relationship-building, meaningful experiences, and personal fulfillment outside of work.</p>
                    </div>
                    <div class="two-columns">
                        <div class="column">
                            <div class="card">
                                <h3>Relationship Milestones</h3>
                                <ul>
                                    <li><span class="status-completed">✓</span> Established meaningful relationship</li>
                                    <li><span class="status-progress">→</span> Building deeper connections</li>
                                </ul>
                            </div>
                            <div class="card">
                                <h3>Travel Experiences</h3>
                                <ul>
                                    <li><span class="status-completed">✓</span> Burgas New Years</li>
                                    <li><span class="status-completed">✓</span> Romania</li>
                                    <li><span class="status-completed">✓</span> Теснолинейка stream event</li>
                                    <li><span class="status-not-started">○</span> Future travel planning</li>
                                </ul>
                           </div>
                           </div>
</div>
<div class="column">
    <div class="card bg-light-green">
        <h3>Work-Life Balance</h3>
        <ul>
            <li><span class="status-progress">→</span> Establishing healthy boundaries</li>
            <li><span class="status-progress">→</span> Integrating streaming with life</li>
            <li><span class="status-progress">→</span> Managing energy effectively</li>
        </ul>
    </div>
</div>
</div>
<div class="card">
<h3>Connection to Goals</h3>
<p>Personal development directly influences content quality and community engagement. By maintaining healthy relationships and experiencing new things, content becomes more authentic and engaging.</p>
</div>
`
},
"n11": {
title: "Twitch Strategy",
content: `
<div class="card bg-light-purple">
<h2>Twitch Streaming Development</h2>
<p>Building a consistent, engaging Twitch presence with technical innovation and community focus.</p>
</div>
<div class="two-columns">
<div class="column">
    <div class="card">
        <h3>Stream Schedule</h3>
        <ul>
            <li><span class="status-progress">→</span> Consistent weekly streams</li>
            <li><span class="status-not-started">○</span> Special event planning</li>
            <li><span class="status-progress">→</span> Audience-friendly timing</li>
        </ul>
    </div>
    <div class="card">
        <h3>Technical Integration</h3>
        <ul>
            <li><span class="status-completed">✓</span> Voice in Chat system</li>
            <li><span class="status-completed">✓</span> Wheel of Fortune</li>
            <li><span class="status-not-started">○</span> Third major integration</li>
        </ul>
    </div>
</div>
<div class="column">
    <div class="card bg-light-green">
        <h3>Content Direction</h3>
        <ul>
            <li>Coding with viewer interaction</li>
            <li>Tech discussions and explorations</li>
            <li>Interactive community features</li>
            <li>Creative problem-solving sessions</li>
        </ul>
    </div>
    <div class="card bg-light-blue">
        <h3>Audience Growth</h3>
        <p>Current Status: 70% toward goal</p>
        <div style="background: #eee; border-radius: 5px; height: 20px; width: 100%; margin-top: 10px;">
            <div style="background: linear-gradient(90deg, var(--color-blue), var(--color-purple)); border-radius: 5px; height: 20px; width: 70%;"></div>
        </div>
    </div>
</div>
</div>
`
},
"n12": {
title: "YouTube Strategy",
content: `
<div class="card">
<h2>YouTube Content Development</h2>
<p>Developing a cohesive YouTube strategy with diverse content formats to reach different audience segments.</p>
</div>
<div class="two-columns">
<div class="column">
    <div class="card bg-light-purple">
        <h3>Content Types</h3>
        <ul>
            <li><span class="status-progress">→</span> Long-form technical content</li>
            <li><span class="status-progress">→</span> Stream highlights and edits</li>
            <li><span class="status-progress">→</span> Shorts from stream moments</li>
            <li><span class="status-not-started">○</span> Independent tutorial series</li>
        </ul>
    </div>
    <div class="card bg-light-blue">
        <h3>Channel Growth</h3>
        <p>Current Status: 45% toward goal</p>
        <div style="background: #eee; border-radius: 5px; height: 20px; width: 100%; margin-top: 10px;">
            <div style="background: linear-gradient(90deg, var(--color-orange), var(--color-yellow)); border-radius: 5px; height: 20px; width: 45%;"></div>
        </div>
    </div>
</div>
<div class="column">
    <div class="card bg-light-green">
        <h3>Content Schedule</h3>
        <ul>
            <li><span class="status-not-started">○</span> Weekly long-form videos</li>
            <li><span class="status-progress">→</span> Bi-weekly shorts</li>
            <li><span class="status-not-started">○</span> Monthly specials</li>
        </ul>
    </div>
    <div class="card bg-yellow-light">
        <h3>Content Strategy</h3>
        <p>The YouTube strategy focuses on providing value through educational content while leveraging the engagement from Twitch streams. Content serves as both standalone material and as a funnel to live streams.</p>
    </div>
</div>
</div>
`
},
"n15": {
title: "Stream Integrations",
content: `
<div class="card" style="border-top: 5px solid var(--color-green);">
<h2>Stream Integration Development</h2>
<p>Creating technical solutions to enhance viewer engagement and stream interactivity.</p>
</div>
<div class="two-columns">
<div class="column">
    <div class="card bg-light-green">
        <h3>Voice in Chat System</h3>
        <p><span class="status-completed">✓</span> COMPLETED</p>
        <p>The Voice in Chat system allows viewers to have messages read aloud during stream, creating a more interactive experience. Features include:</p>
        <ul>
            <li>Multiple voices and languages</li>
            <li>Integration with stream alerts</li>
            <li>Customization options for subscribers</li>
        </ul>
    </div>
</div>
<div class="column">
    <div class="card bg-light-green">
        <h3>Wheel of Fortune</h3>
        <p><span class="status-completed">✓</span> COMPLETED</p>
        <p>An interactive wheel that viewers can spin with bits to win prizes or trigger events. Features include:</p>
        <ul>
            <li>Dynamic prize allocation</li>
            <li>Custom visual effects</li>
            <li>Integration with monetization systems</li>
        </ul>
    </div>
</div>
</div>
<div class="card bg-yellow-light">
<h3>Third Integration (Planned)</h3>
<p><span class="status-not-started">○</span> IN PLANNING</p>
<p>The third integration will focus on creating a more immersive viewer experience. Current concepts under consideration:</p>
<ul>
    <li>Interactive overlays based on stream events</li>
    <li>Viewer-controlled elements in stream scenes</li>
    <li>Community challenge system with rewards</li>
</ul>
</div>
`
},
"n19": {
title: "Monetization Strategy",
content: `
<div class="card" style="border-top: 5px solid var(--color-green);">
<h2>Monetization Framework</h2>
<p>Developing sustainable revenue streams across platforms with integrated viewer benefits.</p>
</div>
< class="two-columns">
<div class="column">
    <div class="card bg-light-green">
        <h3>Primary Revenue Streams</h3>
        <ul>
            <li><span class="status-progress">→</span> Twitch subscriptions</li>
            <li><span class="status-progress">→</span> Bits and donations</li>
            <li><span class="status-not-started">○</span> YouTube channel membership</li>
            <li><span class="status-not-started">○</span> Sponsored content</li>
        </ul>
    </div>
    <div class="card bg-light-blue">
        <h3>Revenue Distribution</h3>
        <div id="revenueChart" style="height: 200px;"></div>
    </div>
</div>
<div class="column">
    <div class="card bg-yellow-light">
        <h3>Viewer Benefits</h3>
        <p>Creating value for supporters through:</p>
        <ul>
            <li>Discord role perks</li>
            <li>Custom stream interactions</li>
            <li>Exclusive content access</li>
            <li>Community recognition</li>
        </ul>
    </div>
    <div class="card">
        <h3>Integration with Content</h3>
        <p>Monetization strategy focuses on enhancing viewer experience rather than interrupting it. Stream integrations like the Wheel of Fortune create organic opportunities for support.</p>
    </div>
</div>
`
}
};

// More script content to follow...

// Initialize D3 flowchart
let svg, g;
let width = window.innerWidth;
let height = window.innerHeight - 100;
let nodes = flowchartData.nodes;
let links = flowchartData.links;
let simulation;
let currentScale = 1;
let currentTranslate = [0, 0];
let nodesData = {};
let linksData = {};

// Parse the links to reference actual node objects
function parseLinks() {
let nodesMap = {};
nodes.forEach(node => {
nodesMap[node.id] = node;
});

return flowchartData.links.map(link => ({
source: nodesMap[link.source],
target: nodesMap[link.target],
bidirectional: link.bidirectional
}));
}

function initializeFlowchart() {
svg = d3.select("#flowchart")
.append("svg")
.attr("width", width)
.attr("height", height)
.call(d3.zoom().on("zoom", function(event) {
currentScale = event.transform.k;
currentTranslate = [event.transform.x, event.transform.y];
g.attr("transform", event.transform);
updateBreadcrumb();
}));

g = svg.append("g");

// Initialize links
linksData = parseLinks();

// Initialize force simulation
simulation = d3.forceSimulation(nodes)
.force("link", d3.forceLink(linksData).id(d => d.id).distance(150))
.force("charge", d3.forceManyBody().strength(-500))
.force("center", d3.forceCenter(width / 2, height / 2))
.force("collide", d3.forceCollide().radius(80))
.on("tick", ticked);

// Create links
let link = g.selectAll(".link")
.data(linksData)
.enter()
.append("path")
.attr("class", "link")
.attr("marker-end", d => d.bidirectional ? "url(#arrowhead-bidirectional)" : "url(#arrowhead)")
.attr("marker-start", d => d.bidirectional ? "url(#arrowhead-start)" : null);

// Add arrowhead marker definition
svg.append("defs").selectAll("marker")
.data(["arrowhead", "arrowhead-bidirectional", "arrowhead-start"])
.enter().append("marker")
.attr("id", d => d)
.attr("viewBox", "0 -5 10 10")
.attr("refX", d => d === "arrowhead-start" ? 0 : 25)
.attr("refY", 0)
.attr("markerWidth", 6)
.attr("markerHeight", 6)
.attr("orient", d => d === "arrowhead-start" ? "auto-start-reverse" : "auto")
.append("path")
.attr("d", "M0,-5L10,0L0,5")
.attr("fill", "#999");

// Create nodes
let nodeGroup = g.selectAll(".node")
.data(nodes)
.enter()
.append("g")
.attr("class", "node")
.call(d3.drag()
.on("start", dragstarted)
.on("drag", dragged)
.on("end", dragended))
.on("click", nodeClicked)
.on("mouseover", nodeMouseOver)
.on("mouseout", nodeMouseOut);

// Add node shapes
nodeGroup.each(function(d) {
let node = d3.select(this);
if (d.shape === "rect") {
node.append("rect")
.attr("rx", 10)
.attr("ry", 10)
.attr("width", 120)
.attr("height", 60)
.attr("fill", d.color)
.attr("stroke", d.borderColor)
.attr("stroke-width", 2);
} else if (d.shape === "diamond") {
node.append("polygon")
.attr("points", "0,-40 60,0 0,40 -60,0")
.attr("fill", d.color)
.attr("stroke", d.borderColor)
.attr("stroke-width", 2);
} else if (d.shape === "text") {
// Just add a small circle for text nodes
node.append("circle")
.attr("r", 15)
.attr("fill", d.color)
.attr("stroke", d.borderColor)
.attr("stroke-width", 2);
} else {
// Default to circle
node.append("circle")
.attr("r", 30)
.attr("fill", d.color)
.attr("stroke", d.borderColor)
.attr("stroke-width", 2);
}

// Add text to all nodes
let textElement = node.append("text")
.attr("class", "node-text")
.attr("text-anchor", "middle")
.attr("fill", d.textColor || "#000")
.attr("dy", d.shape === "text" ? "0.35em" : "0.35em");

// Handle multiline text
if (d.label.includes("<br>")) {
let lines = d.label.split("<br>");
textElement.selectAll("tspan")
.data(lines)
.enter()
.append("tspan")
.attr("x", 0)
.attr("dy", (_, i) => i === 0 ? (d.shape === "text" ? "0" : "-0.6em") : "1.2em")
.text(d => d);
} else {
textElement.text(d.label);
}

// Add icon if available
if (d.icon) {
node.append("text")
.attr("class", "node-icon")
.attr("text-anchor", "middle")
.attr("dy", "0.35em")
.attr("dx", 25)
.attr("font-size", "14px")
.text(d.icon);
}
});

// Store node references
nodesData = nodeGroup.nodes();

// Initial update to position elements
ticked();
}

function ticked() {
// Update link positions
g.selectAll(".link")
.attr("d", d => {
const dx = d.target.x - d.source.x;
const dy = d.target.y - d.source.y;
const dr = Math.sqrt(dx * dx + dy * dy);

// Calculate offset for target based on node size
let targetRadius = 30; // Default circle radius

if (d.target.shape === "rect") {
// For rectangle, calculate distance to edge
const angle = Math.atan2(dy, dx);
const rectWidth = 120;
const rectHeight = 60;

// Approximation of distance to rectangle edge
if (Math.abs(Math.cos(angle)) > Math.abs(Math.sin(angle))) {
    targetRadius = (rectWidth / 2) / Math.abs(Math.cos(angle));
} else {
    targetRadius = (rectHeight / 2) / Math.abs(Math.sin(angle));
}
} else if (d.target.shape === "diamond") {
// For diamond, calculate distance to edge
targetRadius = 40; // Approximate radius
}

// Calculate offset for source based on node size
let sourceRadius = 30; // Default circle radius

if (d.source.shape === "rect") {
// For rectangle, calculate distance to edge
const angle = Math.atan2(dy, dx);
const rectWidth = 120;
const rectHeight = 60;

// Approximation of distance to rectangle edge
if (Math.abs(Math.cos(angle)) > Math.abs(Math.sin(angle))) {
    sourceRadius = (rectWidth / 2) / Math.abs(Math.cos(angle));
} else {
    sourceRadius = (rectHeight / 2) / Math.abs(Math.sin(angle));
}
} else if (d.source.shape === "diamond") {
// For diamond, calculate distance to edge
sourceRadius = 40; // Approximate radius
}

// Calculate direction vector
const unitX = dx / dr;
const unitY = dy / dr;

// Calculate starting point (from source node edge)
const startX = d.source.x + unitX * sourceRadius;
const startY = d.source.y + unitY * sourceRadius;

// Calculate ending point (to target node edge)
const endX = d.target.x - unitX * targetRadius;
const endY = d.target.y - unitY * targetRadius;

return `M${startX},${startY}L${endX},${endY}`;
});

// Update node positions
g.selectAll(".node").attr("transform", d => `translate(${d.x},${d.y})`);
}

function dragstarted(event, d) {
if (!event.active) simulation.alphaTarget(0.3).restart();
d.fx = d.x;
d.fy = d.y;
}

function dragged(event, d) {
d.fx = event.x;
d.fy = event.y;
}

function dragended(event, d) {
if (!event.active) simulation.alphaTarget(0);
d.fx = null;
d.fy = null;
}

function nodeClicked(event, d) {
// Prevent event bubbling
event.stopPropagation();

// Zoom to the clicked node
zoomToNode(d);

// Display node details in modal
displayNodeDetails(d);
}

function nodeMouseOver(event, d) {
// Highlight the node
d3.select(this).attr("transform", d => `translate(${d.x},${d.y}) scale(1.1)`);

// Highlight connected links and nodes
highlightConnections(d);
}

function nodeMouseOut(event, d) {
// Remove highlight from node
d3.select(this).attr("transform", d => `translate(${d.x},${d.y})`);

// Remove highlight from connections
unhighlightConnections();
}

function highlightConnections(node) {
// Find connected links
let connectedLinkIndices = [];
linksData.forEach((link, i) => {
if (link.source.id === node.id || link.target.id === node.id) {
connectedLinkIndices.push(i);
}
});

// Highlight links
g.selectAll(".link")
.filter((d, i) => connectedLinkIndices.includes(i))
.classed("link-active", true);

// Find connected nodes
let connectedNodeIds = [];
linksData.forEach(link => {
if (link.source.id === node.id) {
connectedNodeIds.push(link.target.id);
} else if (link.target.id === node.id) {
connectedNodeIds.push(link.source.id);
}
});

// Highlight nodes
g.selectAll(".node")
.filter(d => connectedNodeIds.includes(d.id))
.each(function() {
d3.select(this).attr("transform", d => `translate(${d.x},${d.y}) scale(1.05)`);
});
}

function unhighlightConnections() {
// Remove highlight from links
g.selectAll(".link").classed("link-active", false);

// Remove highlight from nodes
g.selectAll(".node")
.attr("transform", d => `translate(${d.x},${d.y})`);
}

function zoomToNode(node) {
// Calculate the bounds to focus on
const k = 2; // Zoom level
const tx = width / 2 - node.x * k;
const ty = height / 2 - node.y * k;

// Transition to the new view
svg.transition()
.duration(750)
.call(
d3.zoom().transform,
d3.zoomIdentity.translate(tx, ty).scale(k)
);

// Update current scale and translate
currentScale = k;
currentTranslate = [tx, ty];

// Update breadcrumb
updateBreadcrumb(node);
}

function displayNodeDetails(node) {
// Get node details from the nodeDetails object
const details = nodeDetails[node.id];

if (details) {
// Set modal title and content
document.getElementById("modalBody").innerHTML = `
<h2>${details.title}</h2>
${details.content}
`;

// Show modal
document.getElementById("modalOverlay").classList.add("active");

// Initialize revenue chart if needed
if (node.id === "n19") {
setTimeout(() => {
createRevenueChart();
}, 100);
}
}
}

function createRevenueChart() {
// Sample data for revenue distribution
const data = [
{ label: "Subscriptions", value: 45, color: "#2962FF" },
{ label: "Bits", value: 30, color: "#AA00FF" },
{ label: "Donations", value: 15, color: "#00C853" },
{ label: "Other", value: 10, color: "#FF6D00" }
];

const margin = { top: 20, right: 20, bottom: 30, left: 40 };
const chartWidth = document.getElementById("revenueChart").clientWidth - margin.left - margin.right;
const chartHeight = document.getElementById("revenueChart").clientHeight - margin.top - margin.bottom;

// Clear previous chart if exists
d3.select("#revenueChart").select("svg").remove();

// Create SVG
const chartSvg = d3.select("#revenueChart")
.append("svg")
.attr("width", chartWidth + margin.left + margin.right)
.attr("height", chartHeight + margin.top + margin.bottom)
.append("g")
.attr("transform", `translate(${margin.left},${margin.top})`);

// Create scales
const x = d3.scaleBand()
.domain(data.map(d => d.label))
.range([0, chartWidth])
.padding(0.2);

const y = d3.scaleLinear()
.domain([0, 100])
.range([chartHeight, 0]);

// Create bars
chartSvg.selectAll(".bar")
.data(data)
.enter()
.append("rect")
.attr("class", "bar")
.attr("x", d => x(d.label))
.attr("width", x.bandwidth())
.attr("y", d => y(d.value))
.attr("height", d => chartHeight - y(d.value))
.attr("fill", d => d.color)
.attr("rx", 5)
.attr("ry", 5);

// Add labels
chartSvg.selectAll(".label")
.data(data)
.enter()
.append("text")
.attr("class", "label")
.attr("x", d => x(d.label) + x.bandwidth() / 2)
.attr("y", d => y(d.value) - 5)
.attr("text-anchor", "middle")
.text(d => `${d.value}%`)
.attr("font-size", "12px")
.attr("font-weight", "bold");

// Add X axis
chartSvg.append("g")
.attr("transform", `translate(0,${chartHeight})`)
.call(d3.axisBottom(x))
.selectAll("text")
.attr("font-size", "10px");
}

function updateBreadcrumb(node) {
let breadcrumbText = "Home";

if (node) {
const nodeDetails = nodeDetails[node.id];
if (nodeDetails) {
breadcrumbText += " > " + nodeDetails.title;
} else {
breadcrumbText += " > " + node.label.replace("<br>", " ");
}
}

document.getElementById("breadcrumb").textContent = breadcrumbText;
}

// Initialize zoom controls
function initializeControls() {
// Zoom in button
document.getElementById("zoomIn").addEventListener("click", function() {
svg.transition()
.duration(300)
.call(
d3.zoom().transform,
d3.zoomIdentity
    .translate(currentTranslate[0], currentTranslate[1])
    .scale(currentScale * 1.3)
);

currentScale *= 1.3;
});

// Zoom out button
document.getElementById("zoomOut").addEventListener("click", function() {
svg.transition()
.duration(300)
.call(
d3.zoom().transform,
d3.zoomIdentity
    .translate(currentTranslate[0], currentTranslate[1])
    .scale(currentScale / 1.3)
);

currentScale /= 1.3;
});

// Reset zoom button
document.getElementById("zoomReset").addEventListener("click", function() {
svg.transition()
.duration(300)
.call(
d3.zoom().transform,
d3.zoomIdentity
);

currentScale = 1;
currentTranslate = [0, 0];
updateBreadcrumb();
});

// Reset view button
document.getElementById("resetView").addEventListener("click", function() {
svg.transition()
.duration(750)
.call(
d3.zoom().transform,
d3.zoomIdentity
);

currentScale = 1;
currentTranslate = [0, 0];
updateBreadcrumb();
});

// Expand all button (zoom out to show everything)
document.getElementById("expandAll").addEventListener("click", function() {
// Calculate bounds of the entire graph
let minX = Infinity, minY = Infinity;
let maxX = -Infinity, maxY = -Infinity;

nodes.forEach(node => {
minX = Math.min(minX, node.x);
minY = Math.min(minY, node.y);
maxX = Math.max(maxX, node.x);
maxY = Math.max(maxY, node.y);
});

// Add padding
minX -= 100;
minY -= 100;
maxX += 100;
maxY += 100;

// Calculate scale to fit
const graphWidth = maxX - minX;
const graphHeight = maxY - minY;
const scale = Math.min(width / graphWidth, height / graphHeight) * 0.9;

// Calculate center
const centerX = (minX + maxX) / 2;
const centerY = (minY + maxY) / 2;

// Calculate translate to center
const tx = width / 2 - centerX * scale;
const ty = height / 2 - centerY * scale;

// Apply transform
svg.transition()
.duration(750)
.call(
d3.zoom().transform,
d3.zoomIdentity.translate(tx, ty).scale(scale)
);

// Update current scale and translate
currentScale = scale;

// Continue from where the code stopped
currentTranslate = [tx, ty];
updateBreadcrumb();
});

// Close modal button
document.getElementById("closeModal").addEventListener("click", function() {
    document.getElementById("modalOverlay").classList.remove("active");
});

// Close modal when clicking outside
document.getElementById("modalOverlay").addEventListener("click", function(e) {
    if (e.target === this) {
        this.classList.remove("active");
    }
});
}

// Search functionality
function initializeSearch() {
    const searchInput = document.getElementById("searchInput");
    const searchResults = document.getElementById("searchResults");
    
    searchInput.addEventListener("input", function() {
        const query = this.value.toLowerCase();
        
        // Clear previous results
        searchResults.innerHTML = "";
        
        if (query.length < 2) {
            searchResults.classList.remove("active");
            return;
        }
        
        // Search nodes
        const matchingNodes = nodes.filter(node => 
            node.label.toLowerCase().includes(query) || 
            (nodeDetails[node.id] && nodeDetails[node.id].title.toLowerCase().includes(query))
        );
        
        if (matchingNodes.length > 0) {
            searchResults.classList.add("active");
            
            // Create result items
            matchingNodes.forEach(node => {
                const resultItem = document.createElement("div");
                resultItem.className = "search-result-item";
                resultItem.textContent = nodeDetails[node.id] ? nodeDetails[node.id].title : node.label.replace("<br>", " ");
                
                resultItem.addEventListener("click", function() {
                    // Zoom to the node
                    zoomToNode(node);
                    
                    // Display node details
                    displayNodeDetails(node);
                    
                    // Clear search
                    searchInput.value = "";
                    searchResults.innerHTML = "";
                    searchResults.classList.remove("active");
                });
                
                searchResults.appendChild(resultItem);
            });
        } else {
            searchResults.classList.remove("active");
        }
    });
    
    // Close search results when clicking outside
    document.addEventListener("click", function(e) {
        if (e.target !== searchInput && !searchResults.contains(e.target)) {
            searchResults.classList.remove("active");
        }
    });
}

// Theme toggle functionality
function initializeThemeToggle() {
    const themeToggle = document.getElementById("themeToggle");
    const body = document.body;
    
    // Check if user has a saved preference
    const savedTheme = localStorage.getItem("preferredTheme");
    if (savedTheme === "dark") {
        body.classList.add("dark-theme");
        themeToggle.checked = true;
    }
    
    themeToggle.addEventListener("change", function() {
        if (this.checked) {
            body.classList.add("dark-theme");
            localStorage.setItem("preferredTheme", "dark");
            
            // Update SVG colors for dark theme
            updateSvgForDarkTheme(true);
        } else {
            body.classList.remove("dark-theme");
            localStorage.setItem("preferredTheme", "light");
            
            // Update SVG colors for light theme
            updateSvgForDarkTheme(false);
        }
    });
    
    // Apply theme to SVG on initial load
    if (savedTheme === "dark") {
        updateSvgForDarkTheme(true);
    }
}

function updateSvgForDarkTheme(isDark) {
    if (!svg) return;
    
    if (isDark) {
        // Update links
        g.selectAll(".link")
            .attr("stroke", "#666");
        
        // Update arrowheads
        svg.selectAll("defs marker path")
            .attr("fill", "#666");
        
        // Update node text
        g.selectAll(".node-text")
            .attr("fill", d => d.textColor || "#FFF");
    } else {
        // Revert links
        g.selectAll(".link")
            .attr("stroke", "#999");
        
        // Revert arrowheads
        svg.selectAll("defs marker path")
            .attr("fill", "#999");
        
        // Revert node text
        g.selectAll(".node-text")
            .attr("fill", d => d.textColor || "#000");
    }
}

// Function to handle window resize
function handleResize() {
    width = window.innerWidth;
    height = window.innerHeight - 100;
    
    svg.attr("width", width)
       .attr("height", height);
    
    // Recenter force simulation
    simulation.force("center", d3.forceCenter(width / 2, height / 2));
    simulation.alpha(0.3).restart();
}

// Initialize legend
function initializeLegend() {
    const legendContainer = document.getElementById("legend");
    
    // Get unique node colors and shapes
    const uniqueColors = [...new Set(nodes.map(node => node.color))];
    const uniqueShapes = [...new Set(nodes.map(node => node.shape))];
    
    // Create color legend
    const colorLegend = document.createElement("div");
    colorLegend.className = "legend-section";
    colorLegend.innerHTML = "<h4>Colors</h4>";
    
    uniqueColors.forEach(color => {
        // Find a node with this color to get its meaning
        const exampleNode = nodes.find(node => node.color === color);
        let colorMeaning = "";
        
        // Determine color meaning based on node categories
        if (exampleNode.id.startsWith("n1")) {
            colorMeaning = "Content Creation";
        } else if (exampleNode.id.startsWith("n2")) {
            colorMeaning = "Community Building";
        } else if (exampleNode.id.startsWith("n3")) {
            colorMeaning = "Technical Integration";
        } else {
            colorMeaning = "General Strategy";
        }
        
        const colorItem = document.createElement("div");
        colorItem.className = "legend-item";
        colorItem.innerHTML = `
            <span class="color-sample" style="background-color: ${color};"></span>
            <span>${colorMeaning}</span>
        `;
        
        colorLegend.appendChild(colorItem);
    });
    
    // Create shape legend
    const shapeLegend = document.createElement("div");
    shapeLegend.className = "legend-section";
    shapeLegend.innerHTML = "<h4>Shapes</h4>";
    
    const shapeDescriptions = {
        "rect": "Major Strategy Component",
        "circle": "Implementation Step",
        "diamond": "Decision Point",
        "text": "Informational Element"
    };
    
    uniqueShapes.forEach(shape => {
        const shapeItem = document.createElement("div");
        shapeItem.className = "legend-item";
        
        let shapeHtml = "";
        if (shape === "rect") {
            shapeHtml = '<div class="shape-sample rect"></div>';
        } else if (shape === "circle") {
            shapeHtml = '<div class="shape-sample circle"></div>';
        } else if (shape === "diamond") {
            shapeHtml = '<div class="shape-sample diamond"></div>';
        } else if (shape === "text") {
            shapeHtml = '<div class="shape-sample text-shape"></div>';
        }
        
        shapeItem.innerHTML = `
            ${shapeHtml}
            <span>${shapeDescriptions[shape] || shape}</span>
        `;
        
        shapeLegend.appendChild(shapeItem);
    });
    
    // Add legends to container
    legendContainer.appendChild(colorLegend);
    legendContainer.appendChild(shapeLegend);
    
    // Add toggle functionality
    const legendToggle = document.getElementById("legendToggle");
    legendToggle.addEventListener("click", function() {
        legendContainer.classList.toggle("active");
        this.classList.toggle("active");
    });
}

// Function to export the flowchart as SVG
function exportSvg() {
    // Clone the SVG
    const svgCopy = svg.node().cloneNode(true);
    
    // Set a white background
    const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
    rect.setAttribute("width", "100%");
    rect.setAttribute("height", "100%");
    rect.setAttribute("fill", "white");
    svgCopy.insertBefore(rect, svgCopy.firstChild);
    
    // Convert to string
    const serializer = new XMLSerializer();
    const svgString = serializer.serializeToString(svgCopy);
    
    // Create download link
    const blob = new Blob([svgString], {type: "image/svg+xml"});
    const url = URL.createObjectURL(blob);
    
    const link = document.createElement("a");
    link.download = "project-claude-flowchart.svg";
    link.href = url;
    link.click();
    
    URL.revokeObjectURL(url);
}

// Add export button functionality
function initializeExport() {
    document.getElementById("exportButton").addEventListener("click", exportSvg);
}

// Initialize animated background
function initializeBackground() {
    const canvas = document.getElementById("backgroundCanvas");
    const ctx = canvas.getContext("2d");
    
    // Set canvas dimensions
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    
    // Create particles
    const particles = [];
    const particleCount = 50;
    
    for (let i = 0; i < particleCount; i++) {
        particles.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            radius: Math.random() * 2 + 1,
            speedX: (Math.random() - 0.5) * 0.5,
            speedY: (Math.random() - 0.5) * 0.5,
            color: `rgba(100, 100, 255, ${Math.random() * 0.2 + 0.1})`
        });
    }
    
    // Animation function
    function animate() {
        requestAnimationFrame(animate);
        
        // Clear canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Update and draw particles
        particles.forEach(particle => {
            // Update position
            particle.x += particle.speedX;
            particle.y += particle.speedY;
            
            // Wrap around screen
            if (particle.x < 0) particle.x = canvas.width;
            if (particle.x > canvas.width) particle.x = 0;
            if (particle.y < 0) particle.y = canvas.height;
            if (particle.y > canvas.height) particle.y = 0;
            
            // Draw particle
            ctx.beginPath();
            ctx.arc(particle.x, particle.y, particle.radius, 0, Math.PI * 2);
            ctx.fillStyle = particle.color;
            ctx.fill();
        });
        
        // Draw connections between nearby particles
        particles.forEach((particle, i) => {
            for (let j = i + 1; j < particles.length; j++) {
                const otherParticle = particles[j];
                const dx = particle.x - otherParticle.x;
                const dy = particle.y - otherParticle.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 100) {
                    ctx.beginPath();
                    ctx.moveTo(particle.x, particle.y);
                    ctx.lineTo(otherParticle.x, otherParticle.y);
                    ctx.strokeStyle = `rgba(100, 100, 255, ${0.1 * (1 - distance / 100)})`;
                    ctx.lineWidth = 0.5;
                    ctx.stroke();
                }
            }
        });
    }
    
    // Start animation
    animate();
    
    // Handle window resize
    window.addEventListener("resize", function() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });
}

// Tours functionality
function initializeTours() {
    const tourButton = document.getElementById("tourButton");
    const tourContainer = document.getElementById("tourContainer");
    const tourContent = document.getElementById("tourContent");
    const nextButton = document.getElementById("nextTourStep");
    const prevButton = document.getElementById("prevTourStep");
    const closeTourButton = document.getElementById("closeTour");
    
    let currentStep = 0;
    let tourNodes = [];
    
    // Define tours
    const tours = {
        "contentCreation": {
            title: "Content Creation Strategy",
            description: "Explore the content creation workflow from ideation to publishing",
            nodes: ["n11", "n12"] // IDs of nodes to focus on
        },
        "monetization": {
            title: "Monetization Strategy",
            description: "Understand the revenue streams and viewer benefit integration",
            nodes: ["n19"]
        },
        "techIntegration": {
            title: "Technical Integration",
            description: "See how technical solutions enhance viewer engagement",
            nodes: ["n15"]
        }
    };
    
    // Set up tour selection dropdown
    const tourSelect = document.getElementById("tourSelect");
    
    Object.keys(tours).forEach(tourKey => {
        const option = document.createElement("option");
        option.value = tourKey;
        option.textContent = tours[tourKey].title;
        tourSelect.appendChild(option);
    });
    
    // Tour button click handler
    tourButton.addEventListener("click", function() {
        const selectedTour = tourSelect.value;
        if (selectedTour && tours[selectedTour]) {
            startTour(tours[selectedTour]);
        }
    });
    
    function startTour(tour) {
        // Get nodes for this tour
        tourNodes = tour.nodes.map(nodeId => nodes.find(n => n.id === nodeId));
        currentStep = 0;
        
        // Show tour container
        tourContainer.classList.add("active");
        
        // Update tour title
        document.getElementById("tourTitle").textContent = tour.title;
        
        // Navigate to first step
        showTourStep(0);
    }
    
    function showTourStep(step) {
        if (step >= 0 && step < tourNodes.length) {
            currentStep = step;
            
            // Zoom to node
            zoomToNode(tourNodes[step]);
            
            // Get node details
            const nodeDetail = nodeDetails[tourNodes[step].id];
            
            // Update tour content
            tourContent.innerHTML = `
                <h3>${nodeDetail.title}</h3>
                <div class="tour-content-preview">
                    ${nodeDetail.content.substring(0, 200)}...
                </div>
                <p class="tour-step-indicator">Step ${step + 1} of ${tourNodes.length}</p>
            `;
            
            // Update navigation buttons
            prevButton.disabled = step === 0;
            nextButton.textContent = step === tourNodes.length - 1 ? "Finish" : "Next";
        }
    }
    
    // Tour navigation
    nextButton.addEventListener("click", function() {
        if (currentStep < tourNodes.length - 1) {
            showTourStep(currentStep + 1);
        } else {
            // End tour
            tourContainer.classList.remove("active");
        }
    });
    
    prevButton.addEventListener("click", function() {
        if (currentStep > 0) {
            showTourStep(currentStep - 1);
        }
    });
    
    closeTourButton.addEventListener("click", function() {
        tourContainer.classList.remove("active");
    });
}

// Initialize all components
window.addEventListener("load", function() {
    initializeFlowchart();
    initializeControls();
    initializeSearch();
    initializeThemeToggle();
    initializeLegend();
    initializeExport();
    initializeBackground();
    initializeTours();
    
    // Handle window resize
    window.addEventListener("resize", handleResize);
});